{
    "contents" : "#--------------------------------------------------------\n#  Factor Engineering for kaggle-bike-sharing\n#  Taposh Roy\n#  @taposh_dr\n#--------------------------------------------------------\n\n#Seperating out the outputs from training\nactual<-c()\ncountresult <-c()\ncausal<-c()\nregistered<-c()\ncountresult<-cbind(\"count\"=countresult,bike[,\"count\"])\nactual<-cbind(\"count\"=actual,bike[,\"count\"])\ncausal<-cbind(causal,bike[,\"casual\"])\nregistered<-cbind(registered,bike[,\"registered\"])\n\ncausal<-log(causal)\ncausal[causal[,1]<0,1]<-0\nregistered<-log(registered)\nregistered[registered[,1]<0,1]<-0\nactual<-log(actual)\n#actual[actual[,1]<0,1]<-0\n\n###################\n###Result Analysis\n##################\nresult.train<-c()\nresult.train <- data.frame(countresult)\nhead(result.train)\ncolnames(result.train) <- c(\"actual\")\nresult.stat<-c()\nresult.test<-c()\n\n\n###########################\n#Dealing with datetimes\n###########################\n\ntraintimes<-paste(bike[,\"datetime\"])\ntimes<-paste(test[,\"datetime\"])\n\n#4 variables - hour,day, month and year\nbike<-cbind(bike,\"hour\"=format(as.POSIXct(bike[,\"datetime\"], format=\"%Y-%m-%d %H:%M\"), format=\"%H\"),\n            \"day\"=format(as.POSIXct(bike[,\"datetime\"], format=\"%Y-%m-%d %H:%M\"), format=\"%d\"),\n            \"month\"=format(as.POSIXct(bike[,\"datetime\"], format=\"%Y-%m-%d %H:%M\"), format=\"%m\"),\n            \"year\"=format(as.POSIXct(bike[,\"datetime\"], format=\"%Y-%m-%d %H:%M\"), format=\"%Y\")\n)\nbike[,c(\"hour\",\"day\",\"month\",\"year\")]<-as.matrix(bike[,c(\"hour\",\"day\",\"month\",\"year\")])\n\nfor(i in 1:nrow(bike)){\n  for(j in c(\"hour\",\"day\",\"month\",\"year\")){\n    if(is.na(bike[i,j])){\n      bike[i,j]<-mean(as.numeric(bike[i-1,j]),as.numeric(bike[i+1,j]))}\n  }}\n\ntest<-cbind(test,\"hour\"=format(as.POSIXct(test[,\"datetime\"], format=\"%Y-%m-%d %H:%M\"), format=\"%H\"),\n            \"day\"=format(as.POSIXct(test[,\"datetime\"], format=\"%Y-%m-%d %H:%M\"), format=\"%d\"),\n            \"month\"=format(as.POSIXct(test[,\"datetime\"], format=\"%Y-%m-%d %H:%M\"), format=\"%m\"),\n            \"year\"=format(as.POSIXct(test[,\"datetime\"], format=\"%Y-%m-%d %H:%M\"), format=\"%Y\")\n)\ntest[,c(\"hour\",\"day\",\"month\",\"year\")]<-as.matrix(test[,c(\"hour\",\"day\",\"month\",\"year\")])\n\n######################\n# Actual biketime\n#####################\nSTART<-ISOdate(min(bike[,\"year\"]),min(bike[,\"month\"]),min(bike[,\"day\"]),min(bike[,\"hour\"]))\nbikeTIME<-c()\ntestTIME<-c()\nfor(i in 1:nrow(bike)){\n  bikeTIME<-rbind(bikeTIME,difftime(ISOdate(bike[i,\"year\"],bike[i,\"month\"],bike[i,\"day\"],bike[i,\"hour\"]),START,units=\"hours\"))}\nfor(i in 1:nrow(test)){\n  testTIME<-rbind(testTIME, difftime(ISOdate(test[i,\"year\"],test[i,\"month\"],test[i,\"day\"],test[i,\"hour\"]),START,units=\"hours\"))}\n\nhead(bike,4)\n\n#Weather : removing 4\n#bike$weather[bike$weather == 4] <- 3\n#test$weather[test$weather == 4] <- 3\n\n#http://www.r-bloggers.com/from-continuous-to-categorical/\n#bike$tempfactor<-cut(as.numeric(bike$temp), c(0,5,10,15,20,25,34,41))\n#test$tempfactor<-cut(as.numeric(test$temp), c(0,5,10,15,20,25,34,41))\n\n#bike$tempfactor[bike$tempfactor == \"NA\"] <- \"0\"\n\n\n################################\n#Note: move this to utils.R\n################################\ndayof<-function(X){\n  month<-as.matrix(as.numeric(X[,\"month\"]))\n  month[month==1]<-13\n  month[month==2]<-14\n  day<-as.matrix(as.numeric(X[,\"day\"]))\n  year<-cbind(as.numeric(X[,\"year\"]),as.numeric(X[,\"month\"]))\n  for(i in 1:nrow(year)){\n    if((year[i,2]<=2)==TRUE){year[i,1]<-year[i,1]-1}\n  }\n  year<-as.matrix(year[,1])\n  y<-year %% 2000\n  c<-year - y\n  c<-c/100\n  DAY<-(day+floor(13*(month+1)/5)+y+floor(y/4)+floor(c/4)-c) %% 7\n  return(DAY)}\n\nbike<-cbind(bike,\"dayof\"=dayof(bike))\ntest<-cbind(test,\"dayof\"=dayof(test))\n\ntest<-test[,colnames(test)!=\"datetime\"]\ntest<-test[,colnames(test)!=\"day\"]\ntest<-test[,colnames(test)!=\"year\"]\nbike<-bike[,colnames(test)]\n\n\n\n######################\n## Matrix Interactions\n######################\n# bike1<- model.matrix(~(bikeTIME+bike[,\"windspeed\"]+bike[,\"temp\"]+bike[,\"atemp\"]+bike[,\"humidity\"])^5,bike)\n# test1<- model.matrix(~(testTIME+test[,\"windspeed\"]+test[,\"temp\"]+test[,\"atemp\"]+test[,\"humidity\"])^5,test)\n# \n# colnames(bike)\n# colnames(test)\n# \n# \n# bike <- cbind(bike,bike1)\n# test <- cbind(test,test1)\n\n###########################\n# Other Factors\n###########################\nbike<-cbind(bike,\n            btsaweather= bikeTIME*bike[,\"season\"]*bike[,\"weather\"],\n            btsaweathertemp= bikeTIME*bike[,\"season\"]*bike[,\"weather\"]*bike[,\"temp\"]\n)\n\ntest<-cbind(test,\n            btsaweather= testTIME*test[,\"season\"]*test[,\"weather\"],\n            btsaweathertemp= testTIME*test[,\"season\"]*test[,\"weather\"]*test[,\"temp\"]\n)\n\nbike<-cbind(bike,\n            temp2=(bike[,\"temp\"])^2,\n            atemp2=(bike[,\"atemp\"])^2,\n            humid2=(bike[,\"humidity\"])^2,\n            windspeed2=(bike[,\"windspeed\"])^2,\n            temp3=(bike[,\"temp\"])^3,\n            atemp3=(bike[,\"atemp\"])^3,\n            humid3=(bike[,\"humidity\"])^3,\n            windspeed3=(bike[,\"windspeed\"])^3)\n\ntest<-cbind(test,\n            temp2=test[,\"temp\"]^2,\n            atemp2=test[,\"atemp\"]^2,\n            humid2=test[,\"humidity\"]^2,\n            windspeed2=(test[,\"windspeed\"])^2,\n            temp3=(test[,\"temp\"])^3,\n            atemp3=(test[,\"atemp\"])^3,\n            humid3=(test[,\"humidity\"])^3,\n            windspeed3=(test[,\"windspeed\"])^3)\n\ntest<-cbind(test,\n            t1=sin(4*pi*testTIME/(24)),\n            t2=sin(2*pi*testTIME/(1000))*cos(2*pi*testTIME/(24)),\n            t3=cos(4*pi*testTIME/(24)),\n            #t4=cos(4*pi*testTIME/(1000)),\n            t5=tanh(2*pi*testTIME/(24)),\n            #tanh(2*pi*testTIME/(1000)),\n            t6=tanh(2*pi*testTIME/(365*24)),\n            #t7=tanh(4*pi*testTIME/(24)),\n            #tanh(4*pi*testTIME/(1000)),\n            t8=tanh(4*pi*testTIME/(365*24)),\n            t9=sin(2*pi*testTIME/(24)),\n            #t10=sin(2*pi*testTIME/(1000)),\n            t11=cos(2*pi*testTIME/(24)),\n            #t12=cos(2*pi*testTIME/(1000)),\n            t13=sin(4*pi*testTIME/(356*24)),\n            t14=cos(4*pi*testTIME/(365*24)),\n            t15=sin(2*pi*testTIME/(365*24)),\n            t16=cos(2*pi*testTIME/(365*24)),\n            tt=testTIME)\n\n\nbike<-cbind(bike,\n            t1=sin(4*pi*bikeTIME/(24)),\n            t2=sin(2*pi*bike[,\"temp2\"]/(1000))*cos(2*pi*bikeTIME/(24)),\n            t3=cos(4*pi*bikeTIME/(24)),\n            #t4=cos(4*pi*bikeTIME/(1000)),\n            t5=tanh(2*pi*bikeTIME/(24)),#tanh(2*pi*bikeTIME/(1000)),\n            t6=tanh(2*pi*bikeTIME/(365*24)),\n            #t7=tanh(4*pi*bikeTIME/(24)),#tanh(4*pi*bikeTIME/(1000)),\n            t8=tanh(4*pi*bikeTIME/(365*24)),\n            t9=sin(2*pi*bikeTIME/(24)),\n            #t10=sin(2*pi*bikeTIME/(1000)),\n            t11=cos(2*pi*bikeTIME/(24)),\n            #t12=cos(2*pi*bikeTIME/(1000)),\n            t13=sin(4*pi*bikeTIME/(356*24)),\n            t14=cos(4*pi*bikeTIME/(365*24)),\n            t15=sin(2*pi*bikeTIME/(365*24)),\n            t16=cos(2*pi*bikeTIME/(365*24)),\n            tt=bikeTIME)\n\n# humid and windspeed\ntest<-cbind(test,\n            sinhumid=sin(2*pi*test[,\"humidity\"]/4),\n            coshumid=cos(2*pi*test[,\"humidity\"]/4),\n            sinhumid2=sin(2*pi*test[,\"humid2\"]/10),\n            coshumid2=cos(2*pi*test[,\"humid2\"]/10),\n            sinhumid3=sin(2*pi*test[,\"humid3\"]/(10)),\n            coshumid3=cos(2*pi*test[,\"humid3\"]/(10)),\n            sinwind=sin(2*pi*test[,\"windspeed\"]/(10)),\n            coswind=cos(2*pi*test[,\"windspeed\"]/(10)),\n            sinwind2=sin(2*pi*test[,\"windspeed2\"]/(0.00001)),\n            coswind2=cos(2*pi*test[,\"windspeed2\"]/(0.00001)),\n            sinwind3=sin(2*pi*test[,\"windspeed3\"]/(0.00001)),\n            coswind3=cos(2*pi*test[,\"windspeed3\"]/(0.00001)))\n\nbike<-cbind(bike,\n            sinhumid=sin(2*pi*bike[,\"humidity\"]/4),\n            coshumid=cos(2*pi*bike[,\"humidity\"]/4),\n            sinhumid2=sin(2*pi*bike[,\"humid2\"]/10),\n            coshumid2=cos(2*pi*bike[,\"humid2\"]/10),\n            sinhumid3=sin(2*pi*bike[,\"humid3\"]/(10)),\n            coshumid3=cos(2*pi*bike[,\"humid3\"]/(10)),\n            sinwind=sin(2*pi*bike[,\"windspeed\"]/(10)),\n            coswind=cos(2*pi*bike[,\"windspeed\"]/(10)),\n            sinwind2=sin(2*pi*bike[,\"windspeed2\"]/(0.00001)),\n            coswind2=cos(2*pi*bike[,\"windspeed2\"]/(0.00001)),\n            sinwind3=sin(2*pi*bike[,\"windspeed3\"]/(0.00001)),\n            coswind3=cos(2*pi*bike[,\"windspeed3\"]/(0.00001)))\n\n# # #temp and atemp\nbike<-cbind(bike,\n            sintemp2=sin(2*pi*bike[,\"temp2\"]/(10000)),\n            costemp2=cos(2*pi*bike[,\"temp2\"]/(10000)),\n            sintemp3=sin(2*pi*bike[,\"temp3\"]/(1000000)),\n            costemp3=cos(2*pi*bike[,\"temp3\"]/(1000000)),\n            sinatemp2=sin(2*pi*bike[,\"atemp2\"]/(10000)),\n            cosatemp2=cos(2*pi*bike[,\"atemp2\"]/(10000)),\n            sinatemp3=sin(2*pi*bike[,\"atemp3\"]/(1000000)),\n            cosatemp3=cos(2*pi*bike[,\"atemp3\"]/(1000000)))\n\n\ntest<-cbind(test,\n            sintemp2=sin(2*pi*test[,\"temp2\"]/(10000)),\n            costemp2=cos(2*pi*test[,\"temp2\"]/(10000)),\n            sintemp3=sin(2*pi*test[,\"temp3\"]/(1000000)),\n            costemp3=cos(2*pi*test[,\"temp3\"]/(1000000)),\n            sinatemp2=sin(2*pi*test[,\"atemp2\"]/(10000)),\n            cosatemp2=cos(2*pi*test[,\"atemp2\"]/(10000)),\n            sinatemp3=sin(2*pi*test[,\"atemp3\"]/(1000000)),\n            cosatemp3=cos(2*pi*test[,\"atemp3\"]/(1000000)))\n\nbike<-cbind(bike,\n            bts= bikeTIME*bike[,\"season\"],\n            btw= bikeTIME*bike[,\"weather\"],\n            btt= bikeTIME*bike[,\"temp\"],\n            btsaweather= bikeTIME*bike[,\"season\"]*bike[,\"weather\"],\n            btsaweathertemp= bikeTIME*bike[,\"season\"]*bike[,\"weather\"]*bike[,\"temp\"]\n)\n\ntest<-cbind(test,\n            bts= testTIME*test[,\"season\"],\n            btw= testTIME*test[,\"weather\"],\n            btt= testTIME*test[,\"temp\"],\n            btsaweather= testTIME*test[,\"season\"]*test[,\"weather\"],\n            btsaweathertemp= testTIME*test[,\"season\"]*test[,\"weather\"]*test[,\"temp\"]\n)\n\n# bike<-cbind(bike,\n#             sqrttemp=sqrt(bike[,\"temp\"]),\n#             sqrtatemp=sqrt(bike[,\"atemp\"]),\n#             sqrthumid=sqrt(bike[,\"humidity\"]),\n#             sqrtwindspeed=sqrt(bike[,\"windspeed\"]))\n# \n# test<-cbind(test,\n#             sqrttemp=sqrt(test[,\"temp\"]),\n#             sqrtatemp=sqrt(test[,\"atemp\"]),\n#             sqrthumid=sqrt(test[,\"humidity\"]),\n#             sqrtwindspeed=sqrt(test[,\"windspeed\"]))\n\n# bike<-cbind(bike,\n#             logtemp=log(bike[,\"temp\"]))\n#loghumid=log(bike[,\"humidity\"]))\n#logwindspeed=log(bike[,\"windspeed\"]))\n\n# test<-cbind(test,\n#             logtemp=log(test[,\"temp\"]))\n\n#loghumid=log(test[,\"humidity\"]))\n#logwindspeed=log(test[,\"windspeed\"]))\n\n\n\n\n\n\n#################################################################\n#  Matrix Fun\n#################################################################\n\nA<-cbind(bike[,\"hour\"],bike[,\"dayof\"])\nB<-cbind(test[,\"hour\"],test[,\"dayof\"])\n\nA2<-c()\nB2<-c()\n\nfor(i in unique(B[,1])){\n  for(j in unique(B[,2])){\n    TEMPA<-matrix(data=0,ncol=1,nrow=nrow(bike))\n    colnames(TEMPA) <-paste(\"tmp\", toString(j),toString(i), sep=\"_\")\n    TEMPB<-matrix(data=0,ncol=1,nrow=nrow(test))\n    colnames(TEMPB) <-paste(\"tmp\", toString(j),toString(i), sep=\"_\")\n    TEMPA[A[,1]==i & A[,2]==j,1]<-1\n    TEMPB[B[,1]==i & B[,2]==j,1]<-1\n    A2<-cbind(A2,tmp=TEMPA)\n    B2<-cbind(B2,tmp=TEMPB)\n  }}\n\n#Using hour & Season\nC<-cbind(bike[,\"hour\"],bike[,\"season\"])\nD<-cbind(test[,\"hour\"],test[,\"season\"])\n\nC2<-c()\nD2<-c()\n\nfor(i in unique(C[,1])){\n  for(j in unique(C[,2])){\n    TEMPC<-matrix(data=0,ncol=1,nrow=nrow(bike))\n    colnames(TEMPC) <-paste(\"tmp_c\", toString(j),toString(i), sep=\"_\")\n    TEMPD<-matrix(data=0,ncol=1,nrow=nrow(test))\n    colnames(TEMPD) <-paste(\"tmp_c\", toString(j),toString(i), sep=\"_\")\n    TEMPC[C[,1]==i & C[,2]==j,1]<-1\n    TEMPD[D[,1]==i & D[,2]==j,1]<-1\n    C2<-cbind(C2,tmp_c=TEMPC)\n    D2<-cbind(D2,tmp_c=TEMPD)\n  }}\n\n#head(bike)\n\n\nbike<-cbind(bike,tmp=A2)\ntest<-cbind(test,tmp=B2)\n\nbike<-cbind(bike,tmp_c=C2)\ntest<-cbind(test,tmp_c=D2)\n\n\n\n#Columns Created\ncolnames(bike)\ncolnames(test)\n\n\n\n\n\n\n\n\n##-----tanhh--------### \n#  test<-cbind(test,tanhhwind2=tanh(2*pi*test[,\"windspeed2\"]),tanhwind3=tanh(2*pi*test[,\"windspeed3\"]),tanhumid2=tanh(2*pi*test[,\"humid2\"]),tanhhumid3=tanh(2*pi*test[,\"humid3\"]),tanhwind24=tanh(4*pi*test[,\"windspeed2\"]),tanhwind34=tanh(4*pi*test[,\"windspeed3\"]),tanhumid24=tanh(4*pi*test[,\"humid2\"]),tanhhumid34=tanh(4*pi*test[,\"humid3\"]))\n# #             \n#  bike<-cbind(bike,tanhwind2=tanh(2*pi*bike[,\"windspeed2\"]),tanhwind3=tanh(2*pi*bike[,\"windspeed3\"]),tanhumid2=tanh(2*pi*bike[,\"humid2\"]),tanhhumid3=tanh(2*pi*bike[,\"humid3\"]),tanhwind24=tanh(4*pi*bike[,\"windspeed2\"]),tanhwind34=tanh(4*pi*bike[,\"windspeed3\"]),tanhumid24=tanh(4*pi*bike[,\"humid2\"]),tanhhumid34=tanh(4*pi*bike[,\"humid3\"]))\n\n\n\n\n\n\n\n\n\n###################\n#\n##################\n\nD<-cbind(bike[,\"holiday\"],bike[,\"weather\"])\nE<-cbind(test[,\"holiday\"],test[,\"weather\"])\n\nD2<-c()\nE2<-c()\n\nfor(i in unique(D[,1])){\n  for(j in unique(D[,2])){\n    TEMPD<-matrix(data=0,ncol=1,nrow=nrow(bike))\n    TEMPE<-matrix(data=0,ncol=1,nrow=nrow(test))\n    TEMPD[D[,1]==i & D[,2]==j,1]<-1\n    TEMPE[E[,1]==i & E[,2]==j,1]<-1\n    D2<-cbind(D2,tmp=TEMPD)\n    E2<-cbind(E2,tmp=TEMPE)\n  }}\n\n\n\nG<-cbind(bike[,\"weather\"],bike[,\"month\"])\nH<-cbind(test[,\"weather\"],test[,\"month\"])\n\nG2<-c()\nH2<-c()\n\nfor(i in unique(G[,1])){\n  for(j in unique(G[,2])){\n    TEMPG<-matrix(data=0,ncol=1,nrow=nrow(bike))\n    TEMPH<-matrix(data=0,ncol=1,nrow=nrow(test))\n    TEMPG[G[,1]==i & G[,2]==j,1]<-1\n    TEMPH[H[,1]==i & H[,2]==j,1]<-1\n    G2<-cbind(G2,tmp=TEMPG)\n    H2<-cbind(H2,tmp=TEMPH)\n  }}\n\nJ<-cbind(bike[,\"hour\"],bike[,\"month\"])\nK<-cbind(test[,\"hour\"],test[,\"month\"])\n\nJ2<-c()\nK2<-c()\n\nfor(i in unique(J[,1])){\n  for(j in unique(J[,2])){\n    TEMPJ<-matrix(data=0,ncol=1,nrow=nrow(bike))\n    TEMPK<-matrix(data=0,ncol=1,nrow=nrow(test))\n    TEMPJ[J[,1]==i & J[,2]==j,1]<-1\n    TEMPK[K[,1]==i & K[,2]==j,1]<-1\n    J2<-cbind(J2,tmp=TEMPJ)\n    K2<-cbind(K2,tmp=TEMPK)\n  }}\n\nL<-cbind(bike[,\"holiday\"],bike[,\"month\"])\nM<-cbind(test[,\"holiday\"],test[,\"month\"])\n\nL2<-c()\nM2<-c()\n\nfor(i in unique(L[,1])){\n  for(j in unique(L[,2])){\n    TEMPL<-matrix(data=0,ncol=1,nrow=nrow(bike))\n    TEMPM<-matrix(data=0,ncol=1,nrow=nrow(test))\n    TEMPL[L[,1]==i & L[,2]==j,1]<-1\n    TEMPM[M[,1]==i & M[,2]==j,1]<-1\n    L2<-cbind(L2,tmp=TEMPL)\n    M2<-cbind(M2,tmp=TEMPM)\n  }}\n\nN<-cbind(bike[,\"dayof\"],bike[,\"month\"])\nO<-cbind(test[,\"dayof\"],test[,\"month\"])\n\nN2<-c()\nO2<-c()\n\nfor(i in unique(N[,1])){\n  for(j in unique(N[,2])){\n    TEMPN<-matrix(data=0,ncol=1,nrow=nrow(bike))\n    TEMPO<-matrix(data=0,ncol=1,nrow=nrow(test))\n    TEMPN[N[,1]==i & N[,2]==j,1]<-1\n    TEMPO[O[,1]==i & O[,2]==j,1]<-1\n    N2<-cbind(N2,tmp=TEMPN)\n    O2<-cbind(O2,tmp=TEMPO)\n  }}\n\nbike<-cbind(bike,day_month=N2)\ntest<-cbind(test,day_month=O2)\n\nbike<-cbind(bike,holiday_month=L2)\ntest<-cbind(test,holiday_month=M2)\n\nbike<-cbind(bike,hour_month=J2)\ntest<-cbind(test,hour_month=K2)\n\nbike<-cbind(bike, holiday_weather=D2)\ntest<-cbind(test, holiday_weather=E2)\n\nbike<-cbind(bike, weather_month=G2)\ntest<-cbind(test, weather_month=H2)\n\n# # # # \n# # colnames(bike)\n# # \n# # ####Level 2 A2N2\n# AN<-cbind(bike[,\"weather\"],bike[,\"dayof\"],bike[,\"holiday\"])\n# BO<-cbind(test[,\"weather\"],test[,\"dayof\"],test[,\"holiday\"])\n# \n# AN2<-c()\n# BO2<-c()\n# \n# for(i in unique(AN[,1])){\n#   for(j in unique(AN[,2])){\n#     for(k in unique(AN[,3])){\n#     TEMPAN<-matrix(data=0,ncol=1,nrow=nrow(bike))\n#     TEMPBO<-matrix(data=0,ncol=1,nrow=nrow(test))\n#     TEMPAN[AN[,1]==i & AN[,2]==j & AN[,3]==k,1]<-1\n#     TEMPBO[BO[,1]==i & BO[,2]==j & BO[,3]==k,1]<-1\n#     AN2<-cbind(AN2,tmp=TEMPAN)\n#     BO2<-cbind(BO2,tmp=TEMPBO)\n#   }}}\n# \n# bike<-cbind(bike,holiday_month_weather=AN2)\n# test<-cbind(test,holiday_month_weather=BO2)\n# \n# ###\n# ANY<-cbind(bike[,\"dayof\"],bike[,\"hour\"],bike[,\"month\"])\n# BOY<-cbind(test[,\"dayof\"],test[,\"hour\"],test[,\"month\"])\n# \n# ANY2<-c()\n# BOY2<-c()\n# \n# for(i in unique(ANY[,1])){\n#   for(j in unique(ANY[,2])){\n#     for(k in unique(ANY[,3])){\n#       TEMPANY<-matrix(data=0,ncol=1,nrow=nrow(bike))\n#       TEMPBOY<-matrix(data=0,ncol=1,nrow=nrow(test))\n#       TEMPANY[ANY[,1]==i & ANY[,2]==j & ANY[,3]==k,1]<-1\n#       TEMPBOY[BOY[,1]==i & BOY[,2]==j & BOY[,3]==k,1]<-1\n#       ANY2<-cbind(ANY2,tmp=TEMPANY)\n#       BOY2<-cbind(BOY2,tmp=TEMPBOY)\n#     }}}\n# \n# bike<-cbind(bike,day_hour_month=ANY2)\n# test<-cbind(test,day_hour_month=BOY2)\n# \n# ######\n# \n# ANXW<-cbind(bike[,\"weather\"],bike[,\"holiday\"],bike[,\"hour\"],bike[,\"dayof\"])\n# BOXW<-cbind(test[,\"weather\"],test[,\"holiday\"],test[,\"hour\"],test[,\"dayof\"])\n# \n# ANXW2<-c()\n# BOXW2<-c()\n# \n# for(i in unique(ANXW[,1])){\n#   for(j in unique(ANXW[,2])){\n#     for(k in unique(ANXW[,3])){\n#       for(l in unique(ANXW[,4])){\n#       TEMPANXW<-matrix(data=0,ncol=1,nrow=nrow(bike))\n#       TEMPBOXW<-matrix(data=0,ncol=1,nrow=nrow(test))\n#       TEMPANXW[ANXW[,1]==i & ANXW[,2]==j & ANXW[,3]==k & ANXW[,4]==l,1]<-1\n#       TEMPBOXW[BOXW[,1]==i & BOXW[,2]==j & BOXW[,3]==k & BOXW[,3]==l,1]<-1\n#       ANXW2<-cbind(ANXW2,tmp=TEMPANXW)\n#       BOXW2<-cbind(BOXW2,tmp=TEMPBOXW)\n#     }}}}\n# \n# \n# \n# bike<-cbind(bike,weather_holiday_hr_day=ANXW2)\n# test<-cbind(test,weather_holiday_hr_day=BOXW2)\n\n#################################################################\n#  Categorical Fun\n#################################################################\n\n#\"holiday\",\"workingday\",\"weather\",\"month\",\"hour\",\"dayof\",\"season\"\n# bike2<- model.matrix(~(bike[,\"holiday\"]+bike[,\"workingday\"]+bike[,\"weather\"]+bike[,\"hour\"]+bike[,\"dayof\"]+bike[,\"season\"])^6,bike)\n# test2<- model.matrix(~(test[,\"holiday\"]+test[,\"workingday\"]+test[,\"weather\"]+test[,\"hour\"]+test[,\"dayof\"]+test[,\"season\"])^6,test)\n# \n# bike <- cbind(bike,bike2)\n# test <- cbind(test,test2)\n# \n# colnames(bike)\n# colnames(test)\n\n\n\n\nCategorical<-c(\"holiday\",\"workingday\",\"weather\",\"month\",\"hour\",\"dayof\",\"season\")\nfor(i in Categorical){\n  BT<-bike[i]\n  TT<-test[i]\n  BT2<-c()\n  TT2<-c()\n  for(j in unique(BT[,i])){\n    TempMat<-matrix(data=0,nrow=nrow(BT),ncol=1)\n    colnames(TempMat) <-paste(\"tmpmat\", toString(j),toString(i), sep=\"_\")\n    TempMat2<-matrix(data=0,nrow=nrow(TT),ncol=1)\n    colnames(TempMat2) <-paste(\"tmpmat\", toString(j),toString(i), sep=\"_\")\n    TempMat[BT==j]<-1\n    TempMat2[TT==j]<-1\n    BT2<-cbind(BT2,TempMat)\n    TT2<-cbind(TT2,TempMat2)\n  }\n  bike<-cbind(bike[,colnames(bike)!=i],BT2)\n  test<-cbind(test[,colnames(test)!=i],TT2)\n}\n\nbike<-cbind(bike,Number=matrix(data=1,nrow=nrow(bike),ncol=1))\ntest<-cbind(test,Number=matrix(data=1,nrow=nrow(test),ncol=1))\n\nbike<-data.matrix(bike)\ntest<-data.matrix(test)\n\n\ncolnames(bike)\n#summary(bike)\ncolnames(test)\n#summary(test)\n",
    "created" : 1422301564735.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "910137914",
    "id" : "745D009",
    "lastKnownWriteTime" : 1422344373,
    "path" : "~/workspace/kaggle/bikeshare/factorengineering_bike.R",
    "project_path" : "factorengineering_bike.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}